(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{537:function(s,a,e){"use strict";e.r(a);var l=e(6),t=Object(l.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("最近工作碰到一个需求，需要在Linux系统挂载另外的硬盘，实际操作后，整理出这篇教程。")]),s._v(" "),e("h2",{attrs:{id:"工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#工具"}},[s._v("#")]),s._v(" 工具")]),s._v(" "),e("ol",[e("li",[s._v("VMware")]),s._v(" "),e("li",[s._v("Linux系统")])]),s._v(" "),e("h2",{attrs:{id:"前期准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前期准备"}},[s._v("#")]),s._v(" 前期准备")]),s._v(" "),e("p",[s._v("如果是自己练习的话，可以通过Vmware新建一块空闲分区，用于练习，操作步骤如下：")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("给Vmware上的一台linux机器新增加一块硬盘，在需要增加的linux虚机上点击设置"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount1.png",alt:"点击虚机设置"}})])]),s._v(" "),e("li",[e("p",[s._v("在设备列表中，点击添加，选择硬盘，点击下一步\n"),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount2.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("选择scsi类型的，继续进行下一步"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount3.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("选择创建新虚拟磁盘"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount4.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("添加一块10G的硬盘"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount5.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("给硬盘起个名字，可以的随便起，不重要"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount6.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("确认后硬盘添加完成，看到设备中已经多了一块10G的硬盘"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount7.png",alt:"添加硬盘"}})])]),s._v(" "),e("li",[e("p",[s._v("登录上服务器后，查看硬盘情况")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("可以看到，可用磁盘中没有新增的那一块"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount8.png",alt:"df -h"}})]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" -l\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("这时可以看到，现在Linux系统中，存在一块10G大小的磁盘，但未挂载上，还不能使用。"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2020/10/linux-mount9.png",alt:"fdisk -l"}})])])]),s._v(" "),e("p",[s._v("至此，前期准备就完成了，接下来开始将磁盘挂载到指定目录下，并开始使用它")]),s._v(" "),e("h2",{attrs:{id:"挂载步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#挂载步骤"}},[s._v("#")]),s._v(" 挂载步骤")]),s._v(" "),e("p",[s._v("注：本篇文章只讲解操作步骤，若对其中使用的命令不了解请自行了解。")]),s._v(" "),e("span",{attrs:{id:"parted"}}),s._v(" "),e("h3",{attrs:{id:"使用parted创建分区"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用parted创建分区"}},[s._v("#")]),s._v(" 使用parted创建分区")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("使用parted命令对sdb进行分区")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("parted")]),s._v(" 要分区的磁盘路径\n本文为 "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("parted")]),s._v(" /dev/sdb\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("将MBR磁盘格式化为GPT（磁盘大于2T必须使用gpt类型）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mklabel gpt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建一个分区，为主分区并且分区大小为整个磁盘")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mkpart primary xfs "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("给分区打上lvm标签")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("toggle "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" lvm\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("打印分区信息，对刚才的操作进行核实")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("print\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("操作截图")]),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new1.png",alt:"part /dev/sdb"}})])]),s._v(" "),e("li",[e("p",[s._v("使用fdisk -l查看完成情况")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" -l\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new2.png",alt:"part /dev/sdb"}})]),s._v(" "),e("p",[s._v("可以看到/dev/sdb已经分区完成")]),s._v(" "),e("p",[e("strong",[s._v("注：此处操作硬盘与前期准备新建的不是同一块，故大小不一致。")])])])]),s._v(" "),e("span",{attrs:{id:"pv"}}),s._v(" "),e("h3",{attrs:{id:"将分区加入pv卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#将分区加入pv卷"}},[s._v("#")]),s._v(" 将分区加入pv卷")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("查看当前pv卷")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("pvs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("可以看到目前只有一个sda1"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new3.png",alt:"part /dev/sdb"}})])]),s._v(" "),e("li",[e("p",[s._v("创建新的pv卷")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("pvcreate /dev/sdb1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("并再次查看pv卷可以看到，已经创建成功了。"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new4.png",alt:"part /dev/sdb"}})])])]),s._v(" "),e("h3",{attrs:{id:"创建并将pv卷加入vg卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建并将pv卷加入vg卷"}},[s._v("#")]),s._v(" 创建并将pv卷加入vg卷")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("查看当前vg卷")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("vgs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("可以看到目前只有一个rootvg")])]),s._v(" "),e("li",[e("p",[s._v("创建新的vg卷，并将卷名命名为datavg")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("vgcreate datavg /dev/sdb1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("并再次查看vg卷可以看到，已经创建成功了。")]),s._v(" "),e("p",[e("strong",[s._v("操作截图")]),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new5.png",alt:"part /dev/sdb"}})])])]),s._v(" "),e("h3",{attrs:{id:"创建并将vg卷加入lv卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建并将vg卷加入lv卷"}},[s._v("#")]),s._v(" 创建并将vg卷加入lv卷")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("查看当前lv卷")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("lvs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建逻辑卷"),e("br"),s._v("\n-L 指定分区大小 -n 指定lvm名称，本次命名为lv_desc_1")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("lvcreate -l +100%FREE  -n lv_desc_1  datavg\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("并再次查看lv卷可以看到，已经创建成功了。")])]),s._v(" "),e("li",[e("p",[s._v("格式化lv卷"),e("br"),s._v("\n使用mkfs.xfs命令在逻辑卷lvmServer上创建xfs文件系统，格式化为xfs类型文件系统，运行性能好")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mkfs.xfs /dev/datavg/lv_desc_1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("操作截图")]),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new6.png",alt:"part /dev/sdb"}})]),s._v(" "),e("p",[s._v("此时，我们的硬盘已经完全配置完成了，接下来将硬盘挂载到指定的目录下。")])])]),s._v(" "),e("h3",{attrs:{id:"挂载到磁盘文件夹下"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#挂载到磁盘文件夹下"}},[s._v("#")]),s._v(" 挂载到磁盘文件夹下")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("首先查看当前已挂载的硬盘，可以看到还是没有刚才配置的那块。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建想挂载硬盘的目录")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /app\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("将硬盘挂载到指定目录下")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" /dev/datavg/lv_desc_1 /app\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("再次查看挂载情况，可以看到已经挂载完成了。")]),s._v(" "),e("p",[e("strong",[s._v("操作截图")]),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new7.png",alt:"part /dev/sdb"}})]),s._v(" "),e("p",[s._v("进入挂载目录，新建文件进行测试，磁盘可以正常读写就没问题了。")])]),s._v(" "),e("li",[e("p",[s._v("为了防止机器重启，导致硬盘无法自动挂载，新挂载硬盘必须增加开机自动挂载文件配置，编辑文件/etc/fstab增加如下信息："),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new8.png",alt:"part /dev/sdb"}})]),s._v(" "),e("p",[s._v("文件中开头内容可对照df -h命令，挂载路径对应行的文件系统列，复制使用即可。"),e("br"),s._v(" "),e("img",{attrs:{src:"/img/blogs/2021/08/linux-mount-new9.png",alt:"part /dev/sdb"}})])])]),s._v(" "),e("p",[s._v("至此，磁盘就挂载完成了")]),s._v(" "),e("h2",{attrs:{id:"磁盘扩容"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#磁盘扩容"}},[s._v("#")]),s._v(" 磁盘扩容")]),s._v(" "),e("p",[s._v("实际工作中，会碰到硬盘用完了，增加新硬盘后，追加至同一块硬盘的需求。"),e("br"),s._v(" "),e("strong",[s._v("此处的扩容实际操作为对lvm扩展分区大小")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("创建pv卷\n依次重复挂载步骤中使用partedd创建分区与将分区加入pv卷操作"),e("br"),s._v("\n(1) "),e("a",{attrs:{href:"#parted",title:"使用parted创建分区"}},[s._v("使用parted创建分区")]),e("br"),s._v("\n(2) "),e("a",{attrs:{href:"#pv",title:"将分区加入pv卷"}},[s._v("将分区加入pv卷")])])]),s._v(" "),e("li",[e("p",[s._v("将pv卷扩展到vg卷"),e("br"),s._v("\n假定物理卷组为/dev/sdb2，执行命令")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("vgextend datavg /dev/sdb2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("对lv卷进行扩容"),e("br"),s._v("\n对lv进行在线(动态)扩容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("lvextend -l +100%FREE /dev/mapper/datavg-lv_desc_1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("刷新文件系统使扩容生效")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("xfs_growfs /dev/mapper/datavg-lv_desc_1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("至此，磁盘就扩容完成了")])])}),[],!1,null,null,null);a.default=t.exports}}]);