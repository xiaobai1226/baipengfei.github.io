(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{539:function(s,a,n){"use strict";n.r(a);var t=n(6),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"harbor介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#harbor介绍"}},[s._v("#")]),s._v(" Harbor介绍")]),s._v(" "),n("h2",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取安装包")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/goharbor/harbor/releases/download/v2.3.2/harbor-offline-installer-v2.3.2.tgz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压安装包")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xvf harbor-offline-installer-v2.3.2.tgz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("解压完成后，可以看到如下文件："),n("br"),s._v(" "),n("img",{attrs:{src:"/img/blogs/2021/08/harbor-tar-file.png",alt:"文件截图"}})]),s._v(" "),n("p",[s._v("其中有harbor.yml.tmpl文件，将其复制出来重命名为harbor.yml，并修改其中的内容")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Configuration file of Harbor")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostname设置访问地址，可以使用ip、域名，不可以设置为127.0.0.1或localhost")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".159.128\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 访问协议，默认是http，也可以设置https，如果设置https，则nginx ssl需要设置on")]),s._v("\nui_url_protocol "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" http\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql数据库root用户默认密码root123，实际使用时修改下")]),s._v("\ndb_password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root123\n\nmax_job_workers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" \ncustomize_crt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https相关不用可以不设置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssl_cert = /data/cert/server.crt")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssl_cert_key = /data/cert/server.key")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# secretkey_path = /data")]),s._v("\nadmiral_url "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NA\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 邮件设置，发送重置密码邮件时使用")]),s._v("\nemail_identity "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" \nemail_server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" smtp.mydomain.com\nemail_server_port "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\nemail_username "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sample_admin@mydomain.com\nemail_password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" abc\nemail_from "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" admin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sample_admin@mydomain.com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nemail_ssl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动Harbor后，管理员UI登录的密码，默认是Harbor12345")]),s._v("\nharbor_admin_password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Harbor12345\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 认证方式，这里支持多种认证方式，如LADP、本次存储、数据库认证。默认是db_auth，mysql数据库认证")]),s._v("\nauth_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" db_auth\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LDAP认证时配置项")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_url = ldaps://ldap.mydomain.com")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_searchdn = uid=searchuser,ou=people,dc=mydomain,dc=com")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_search_pwd = password")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_basedn = ou=people,dc=mydomain,dc=com")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_filter = (objectClass=person)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_uid = uid ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_scope = 3 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ldap_timeout = 5")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否开启自注册")]),s._v("\nself_registration "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Token有效时间，默认30分钟")]),s._v("\ntoken_expiration "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户创建项目权限控制，默认是everyone（所有人），也可以设置为adminonly（只能管理员）")]),s._v("\nproject_creation_restriction "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" everyone\n\nverify_remote_cert "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br")])]),n("p",[s._v("修改完配置文件后，分别执行prepare文件与install.sh。")]),s._v(" "),n("p",[s._v("修改/etc/docker/daemon.json")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在json中增加如下配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"insecure-registries"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.169.136.38:10082"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启Docker服务")]),s._v("\nsystemctl daemon-reload\nsystemctl restart docker \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("此时就已安装完成了")]),s._v(" "),n("h2",{attrs:{id:"登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[s._v("#")]),s._v(" 登录")]),s._v(" "),n("h3",{attrs:{id:"页面登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#页面登录"}},[s._v("#")]),s._v(" 页面登录")]),s._v(" "),n("p",[s._v("根据配置中的地址，http://10.100.159.128:10082即可登录web管理页面进行使用。")]),s._v(" "),n("h3",{attrs:{id:"命令登录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令登录"}},[s._v("#")]),s._v(" 命令登录")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker login -u admin -p "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.169")]),s._v(".136.38:10082\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);